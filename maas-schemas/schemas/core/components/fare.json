{
  "$id": "http://maasglobal.com/core/components/fare.json",
  "description": "A fare/price as billed to the user in WMPs or in tokens",
  "type": "object",
  "definitions": {
    "tokenId": {
      "type": "string",
      "pattern": "^[a-z]+(-[a-z]+)*-[a-z0-9_]+$"
    },
    "fareTypeCHARGE": { "const": "charge" },
    "fareTypeREFUND": { "const": "refund" },
    "fareType": {
      "oneOf": [
        { "$ref": "#/definitions/fareTypeCHARGE" },
        { "$ref": "#/definitions/fareTypeREFUND" }
      ]
    },
    "wmpAmount": {
      "description": "An amount of in-app credits",
      "type": "integer",
      "minimum": 0,
      "multipleOf": 1,
      "examples": [1234]
    },
    "wmpBalance": {
      "description": "An amount of in-app credits, with currency type info",
      "type": "object",
      "properties": {
        "currency": { "$ref": "http://maasglobal.com/core/components/units.json#/definitions/metaCurrencyWMP" },
        "amount": { "$ref": "#/definitions/wmpAmount" },
        "originalAmount": {
          "$ref": "#/definitions/wmpAmount"
        },
        "productionAmount": {
          "$ref": "#/definitions/wmpAmount"
        },
        "type": {
          "$ref": "#/definitions/fareType"
        }
      },
      "required": ["currency", "amount"],
      "additionalProperties": false,
      "examples": [
        {
          "currency": "WMP",
          "amount": 1234,
          "type": "charge"
        }
      ]
    },
    "tokenAmount": {
      "description": "An amount of in-app tokens",
      "type": "integer",
      "minimum": 0,
      "examples": [1]
    },
    "tokenBalance": {
      "description": "An amount of in-app tokens, with currency type info",
      "type": "object",
      "description": "key would typically match tokenId",
      "properties": {
        "currency": { "$ref": "http://maasglobal.com/core/components/units.json#/definitions/metaCurrencyTOKEN" },
        "tokenId": {
          "$ref": "#/definitions/tokenId"
        },
        "amount": { "$ref": "#/definitions/tokenAmount" },
        "originalAmount": {
          "$ref": "#/definitions/tokenAmount"
        },
        "productionAmount": {
          "$ref": "#/definitions/tokenAmount"
        },
        "type": {
          "$ref": "#/definitions/fareType"
        }
      },
      "required": ["currency", "tokenId", "amount"],
      "additionalProperties": false,
      "examples": [
        {
          "currency": "TOKEN",
          "tokenId": "cx-test-token_v2",
          "amount": 1,
          "type": "charge"
        }
      ]
    },
    "anyBalance": {
      "oneOf": [
        { "$ref": "#/definitions/wmpBalance" },
        { "$ref": "#/definitions/tokenBalance" }
      ]
    },
    "balancesArray": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/anyBalance"
      }
    },
    "balancesObject": {
      "description": "A summary of in-app credit and tokens",
      "type": "object",
      "properties": {
        "WMP": { "$ref": "#/definitions/wmpBalance" }
      },
      "patternProperties": {
        "^[a-z]+(-[a-z]+)*-[a-z0-9_]+$": { "$ref": "#/definitions/tokenBalance" }
      },
      "required": ["WMP"],
      "additionalProperties": false,
      "examples": [
        {
          "WMP": {
            "currency": "WMP",
            "amount": 1234,
            "type": "charge"
          },
          "cx-test-token_v2": {
            "currency": "TOKEN",
            "tokenId": "cx-test-token_v2",
            "amount": 1,
            "type": "charge"
          }
        }
      ]
    }
  },
  "allOf": [
    { "$ref": "#/definitions/anyBalance" }
  ]
}
